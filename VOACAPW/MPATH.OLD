c###mpath.for
      SUBROUTINE MPATH(IF)
C--------------------------------
C
C     THIS ROUTINE PERFORMS THE MULTIPATH PROBABILITY AND DETERMINES
C     IF ANY OTHER MODE WILL INTERFERE WITH THE MOST RELIABLE MODE
C
      COMMON /DON /ALATD, AMIN, AMIND, BTR, BTRD, DLONG, DMP, ERTR, GCD,
     1 GCDKM, PMP, PWR, TLAT, TLATD, TLONG, TLONGD, RSN, SIGTR, RLAT,
     2 RLATD,RLONG,RLONGD,BRTD,FLUX,ULAT,ULATD,ULONG,ULONGD,SSN,D90R,
     3 D50R,D10R,D90S,D50S,D10S
      COMMON / SON / ANGLE(13), ANGLER(13), CPROB(13), DBLOS(13),
     A DBLOSL(13), DBLOSU(13), DBU(13), DELAY(13), DBW(13), NHP(13),
     B XNYNOIS(13), PROBMP(13), RELIAB(13), SNDB(13), SNPR(13),
     C SNRLW(13), SNRUP(13), SPROB(13), VHIGH(13), MDL(13), RNEFF(13)
       CHARACTER MDL*1
      COMMON / allMODE /ABPS(20),CREL(20),FLDST(20),HN(20),HP(20),
     1PROB(20),RELY(20),RGAIN(20),SIGPOW(20),SN(20),
     2SPRO(20),TGAIN(20),TIMED(20),TLOSS(20),B(20),FSLOS(20),
     3grlos(20),adv(20),obf(20),
     CNMODE(20),TLLOW(20),TLHGH(20),EFF(20),NREL,NMMOD
      IF(DMP) 95,95,100
   95 RETURN
  100 CONTINUE
      XTLOS = DBLOS(IF)
      PROBMP(IF) = 0.001
      TTIM = DELAY(IF)
      DO 135 IM = 1,NMMOD
      IF( IM - NREL)  105,135,105
  105 CONTINUE
      IF( HP(IM) ) 135,135,110
C.....CHECK ON TIME DELAY
  110 IF( ABS(TIMED(IM) - TTIM) - DMP ) 135,135,115
  115 IF(ABS(TLOSS(IM) - XTLOS) - PMP) 120, 120, 135
C.....CHECK ON POWER
  120 PROBMP(IF) = AMAX1( PROBMP(IF),RELY(IM))
  135 CONTINUE
      RETURN
      END
C--------------------------------
